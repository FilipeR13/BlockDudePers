<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa4_2021li1g055</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Lucas Quintela &lt;a100642@alunos.uminho.pt&gt;;<br />: Jos&#233; Rodrigues &lt;a100692@alunos.uminho.pt&gt;;</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa4_2021li1g055</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 4 do projeto de LI1 em 2021/22.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:moveJogador">moveJogador</a> :: <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a> -&gt; <a href="LI12122.html#t:Movimento" title="LI12122">Movimento</a> -&gt; <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a></li><li class="src short"><a href="#v:movimentovalido">movimentovalido</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; Bool</li><li class="src short"><a href="#v:verificaposicaoesquerda">verificaposicaoesquerda</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></li><li class="src short"><a href="#v:movimentoesquerdaBloco">movimentoesquerdaBloco</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; Bool</li><li class="src short"><a href="#v:verificaposicaodireita">verificaposicaodireita</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></li><li class="src short"><a href="#v:movimentodireitaBloco">movimentodireitaBloco</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; Bool</li><li class="src short"><a href="#v:subir">subir</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; Bool</li><li class="src short"><a href="#v:subirBloco">subirBloco</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; Bool</li><li class="src short"><a href="#v:apanhacaixa">apanhacaixa</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; <a href="LI12122.html#t:Direcao" title="LI12122">Direcao</a> -&gt; <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a></li><li class="src short"><a href="#v:substituicaixa">substituicaixa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; (<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>) -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</li><li class="src short"><a href="#v:pousaCaixa">pousaCaixa</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; <a href="LI12122.html#t:Direcao" title="LI12122">Direcao</a> -&gt; <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a></li><li class="src short"><a href="#v:pousaCaixaAux">pousaCaixaAux</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; (<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)</li><li class="src short"><a href="#v:correrMovimentos">correrMovimentos</a> :: <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a> -&gt; [<a href="LI12122.html#t:Movimento" title="LI12122">Movimento</a>] -&gt; <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:moveJogador" class="def">moveJogador</a> :: <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a> -&gt; <a href="LI12122.html#t:Movimento" title="LI12122">Movimento</a> -&gt; <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a> <a href="#v:moveJogador" class="selflink">#</a></p><div class="doc"><h2>Move Jogador</h2><p>A fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:moveJogador" title="Tarefa4_2021li1g055">moveJogador</a></code> &#233; a fun&#231;&#227;o que recebe o jogo e o movimento. </p><ul><li>AndarEsquerda: A fun&#231;&#227;o verifica, com recurso &#224;s fun&#231;&#245;es <code><a href="Tarefa4_2021li1g055.html#v:movimentovalido" title="Tarefa4_2021li1g055">movimentovalido</a></code> e <code><a href="Tarefa4_2021li1g055.html#v:movimentoesquerdaBloco" title="Tarefa4_2021li1g055">movimentoesquerdaBloco</a></code> (caso o jogador esteja a carregar um bloco), se o jogador pode avan&#231;ar para a esquerda.
Se puder andar ent&#227;o vai devolver o mapa com o jogador na sua nova posi&#231;&#227;o, calculada pela fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:verificaposicaoesquerda" title="Tarefa4_2021li1g055">verificaposicaoesquerda</a></code>.</li><li>AndarDireita: A fun&#231;&#227;o verifica, com recurso &#224;s fun&#231;&#245;es <code><a href="Tarefa4_2021li1g055.html#v:movimentovalido" title="Tarefa4_2021li1g055">movimentovalido</a></code> e <code><a href="Tarefa4_2021li1g055.html#v:movimentodireitaBloco" title="Tarefa4_2021li1g055">movimentodireitaBloco</a></code> (caso o jogador esteja a carregar um bloco), se o jogador pode avan&#231;ar para a direita.
Se puder andar ent&#227;o vai devolver o mapa com o jogador na sua nova posi&#231;&#227;o, calculada pela fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:verificaposicaodireita" title="Tarefa4_2021li1g055">verificaposicaodireita</a></code>.</li><li>Trepar: A fun&#231;&#227;o come&#231;a por verificar se o jogador pode trepar um bloco, testando se este se encontra na ordenada igual a 0 ou se est&#225; na ordenada igual a 1 se estiver a carregar um bloco, pois
estando numa coordenada assim, o jogador n&#227;o tem como subir nenhum bloco. Para al&#233;m disso, se o jogador estiver nos limites laterais do mapa e ao mesmo tempo estiver virado para esse mesmo limite,
a fun&#231;&#227;o devolve o mapa sem o modificar pois o jogador n&#227;o pode trepar para nenhum lado. Passado estes casos a fun&#231;&#227;o verifica se n&#227;o h&#225; blocos em cima jogador e se existe um bloco/caixa em que este
possa subir com recurso &#224;s fun&#231;&#245;es <code><a href="Tarefa4_2021li1g055.html#v:subir" title="Tarefa4_2021li1g055">subir</a></code> e <code><a href="Tarefa4_2021li1g055.html#v:subirBloco" title="Tarefa4_2021li1g055">subirBloco</a></code>, completando assim o movimento e devolvendo o mapa com o jogador na nova posi&#231;&#227;o. </li><li>InterageCaixa: A fun&#231;&#227;o primeiro verifica existem caixas &#224; volta do jogador que este possa pegar. De seguida a fun&#231;&#227;o divide-se em dois casos. Quando o jogador n&#227;o est&#225; a carregar uma caixa, ent&#227;o
vai usar a fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:apanhacaixa" title="Tarefa4_2021li1g055">apanhacaixa</a></code> para verificar se pode pegar na caixa. Quando o jogador est&#225; a carregar uma caixa, a fun&#231;&#227;o ir&#225; usar a fun&#231;&#227;o auxiliar <code><a href="Tarefa4_2021li1g055.html#v:pousaCaixa" title="Tarefa4_2021li1g055">pousaCaixa</a></code> para averiguar se pode pousar a caixa.</li></ul></div></div><div class="top"><p class="src"><a id="v:movimentovalido" class="def">movimentovalido</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; Bool <a href="#v:movimentovalido" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:movimentovalido" title="Tarefa4_2021li1g055">movimentovalido</a></code> come&#231;a por verificar se o jogador se encontra a tentar mover-se para fora dos limites do mapa laterais, pelo que devolve False. De seguida verifica se existe uma Caixa ou
um bloco na posi&#231;&#227;o para a qual o jogador quer ir, se existir devolve False. Se nenhum dos ultimos casos se verificar, a fun&#231;&#227;o ir&#225; devolver True. </p></div></div><div class="top"><p class="src"><a id="v:verificaposicaoesquerda" class="def">verificaposicaoesquerda</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> <a href="#v:verificaposicaoesquerda" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:verificaposicaoesquerda" title="Tarefa4_2021li1g055">verificaposicaoesquerda</a></code> calcula a coordenada para a qual o jogador se vai deslocar, verificando o ch&#227;o &#224; sua frente. Se n&#227;o existir ch&#227;o imediatamente &#224; frete do jogador, a fun&#231;&#227;o
ir&#225; ser chamada recursivamente com a ordenada do jogador com mais unidade, procurando assim o ch&#227;o em que o jogador ir&#225; ficar. Quando encontrar o ch&#227;o, vai devolver a posi&#231;&#227;o do jogador.</p></div></div><div class="top"><p class="src"><a id="v:movimentoesquerdaBloco" class="def">movimentoesquerdaBloco</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; Bool <a href="#v:movimentoesquerdaBloco" class="selflink">#</a></p><div class="doc"><p>Esta fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:movimentoesquerdaBloco" title="Tarefa4_2021li1g055">movimentoesquerdaBloco</a></code> &#233; usada para verificar se o jogador pode avan&#231;ar mesmo estando a carregar um bloco. Essencialmente, esta fun&#231;&#227;o verifica as mesmas coisas que a fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:movimentovalido" title="Tarefa4_2021li1g055">movimentovalido</a></code>
com a adi&#231;&#227;o da condi&#231;&#227;o de que n&#227;o deve existir um bloco nas coordenadas (x-1,y-1), sendo (x,y) as coordenadas do jogador, pois assim a caixa assim n&#227;o poder&#225; passar.</p></div></div><div class="top"><p class="src"><a id="v:verificaposicaodireita" class="def">verificaposicaodireita</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> <a href="#v:verificaposicaodireita" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:movimentodireitaBloco" class="def">movimentodireitaBloco</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; Bool <a href="#v:movimentodireitaBloco" class="selflink">#</a></p><div class="doc"><p>Esta fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:movimentodireitaBloco" title="Tarefa4_2021li1g055">movimentodireitaBloco</a></code> &#233; usada para verificar se o jogador pode avan&#231;ar mesmo estando a carregar um bloco. Essencialmente, esta fun&#231;&#227;o verifica as mesmas coisas que a fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:movimentovalido" title="Tarefa4_2021li1g055">movimentovalido</a></code>
com a adi&#231;&#227;o da condi&#231;&#227;o de que n&#227;o deve existir um bloco nas coordenadas (x+1,y-1), sendo (x,y) as coordenadas do jogador, pois assim a caixa assim n&#227;o poder&#225; passar.</p></div></div><div class="top"><p class="src"><a id="v:subir" class="def">subir</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; Bool <a href="#v:subir" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:subir" title="Tarefa4_2021li1g055">subir</a></code> tem como objetivo verificar se o jogador tem algum bloco ou caixa que possa trepar. Para al&#233;m disso, este tamb&#233;m verifica se tem algum bloco em cima do que este quer subir, pois se 
existir o  jogador n&#227;o poder&#225; subir.</p></div></div><div class="top"><p class="src"><a id="v:subirBloco" class="def">subirBloco</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; Bool <a href="#v:subirBloco" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:subirBloco" title="Tarefa4_2021li1g055">subirBloco</a></code> tem praticamente o mesmo objetivo que a fun&#231;&#227;o anterior (<code><a href="Tarefa4_2021li1g055.html#v:subir" title="Tarefa4_2021li1g055">subir</a></code>) com a adi&#231;&#227;o da verifica&#231;&#227;o se existe algum bloco no local onde a caixa ir&#225; ficar depois de o jogador trepar
pois, se existir,  o jogador n&#227;o poder&#225; trepar.</p></div></div><div class="top"><p class="src"><a id="v:apanhacaixa" class="def">apanhacaixa</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; <a href="LI12122.html#t:Direcao" title="LI12122">Direcao</a> -&gt; <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a> <a href="#v:apanhacaixa" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:apanhacaixa" title="Tarefa4_2021li1g055">apanhacaixa</a></code> verifica se existe algum bloco em cima do jogador e se tamb&#233;m existe uma caixa ou bloco em cima da caixa que se pretende pegar, pois nestas situa&#231;&#245;es o jogador n&#227;o poder&#225;
pegar na caixa. De seguida, ap&#243;s verificar que existe uma caixa na dire&#231;&#227;o que o jogador est&#225; virado, a fun&#231;&#227;o ir&#225; devolver o jogo retirando a caixa que foi carregada do mapa (com ajuda da fun&#231;&#227;o
<code><a href="Tarefa4_2021li1g055.html#v:substituicaixa" title="Tarefa4_2021li1g055">substituicaixa</a></code>) e passando o booleano do jogador a True. </p></div></div><div class="top"><p class="src"><a id="v:substituicaixa" class="def">substituicaixa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; (<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>) -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] <a href="#v:substituicaixa" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:substituicaixa" title="Tarefa4_2021li1g055">substituicaixa</a></code> tem como objetivo retirar a caixa que foi carregada pelo jogador do mapa. Para isso ela vai comparando as coordenadas da caixa na lista de pe&#231;as e coordenadas do mapa. Quando
encontrar as coordenadas a fun&#231;&#227;o devolve o mapa sem a caixa, tirando-a da lista, ficando assim declarado um Vazio por omiss&#227;o.</p></div></div><div class="top"><p class="src"><a id="v:pousaCaixa" class="def">pousaCaixa</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; <a href="LI12122.html#t:Direcao" title="LI12122">Direcao</a> -&gt; <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a> <a href="#v:pousaCaixa" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:pousaCaixa" title="Tarefa4_2021li1g055">pousaCaixa</a></code> come&#231;a por verificar se as condi&#231;&#245;es s&#227;o favor&#225;veis para largar a caixa. Come&#231;a por verificar se o jogador est&#225; virado para um limites laterais do mapa, pelo que n&#227;o pode largar
a caixa. De seguida verifica se existe um bloco ou caixa em cima da posi&#231;&#227;o para onde se pretende pousar a caixa, se existir, a fun&#231;&#227;o devolve o jogo tal como o recebeu. Ap&#243;s passar pelas verifica&#231;&#245;es
anteriores, a fun&#231;&#227;o verifica se o jogador tem um bloco ou caixa &#224; sua frente, pois se existir a fun&#231;&#227;o ir&#225; colocar a caixa na posi&#231;&#227;o acima desse bloco/caixa. Por fim, a fun&#231;&#227;o procura o ch&#227;o onde
a caixa vai ficar, devolvendo a caixa na posi&#231;&#227;o que corresponde &#224; posi&#231;&#227;o em cima desse ch&#227;o, para isso a fun&#231;&#227;o precisa de uma fun&#231;&#227;o auxiliar <code><a href="Tarefa4_2021li1g055.html#v:pousaCaixaAux" title="Tarefa4_2021li1g055">pousaCaixaAux</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:pousaCaixaAux" class="def">pousaCaixaAux</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; (<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>) <a href="#v:pousaCaixaAux" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:pousaCaixaAux" title="Tarefa4_2021li1g055">pousaCaixaAux</a></code> come&#231;a por verificar se existe o ch&#227;o imediatamente &#224; frente do jogador. Se este n&#227;o existir, a fun&#231;&#227;o &#233; chamada recursivamente para a posi&#231;&#227;o da linha abaixo, para assim procurar
o ch&#227;o mais abaixo.</p></div></div><div class="top"><p class="src"><a id="v:correrMovimentos" class="def">correrMovimentos</a> :: <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a> -&gt; [<a href="LI12122.html#t:Movimento" title="LI12122">Movimento</a>] -&gt; <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a> <a href="#v:correrMovimentos" class="selflink">#</a></p><div class="doc"><h2>Correr Movimentos</h2><p>A fun&#231;&#227;o <code>corrermovimentos</code> vai aplicar cada movimento de uma lista a um jogo utilizando a fun&#231;&#227;o <code><a href="Tarefa4_2021li1g055.html#v:moveJogador" title="Tarefa4_2021li1g055">moveJogador</a></code> defenida anteriormente.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>